<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <title>${(metadata.alias)!}</title>
        <@_includePlace path="/8ddab9ba-a8aa-4745-86c6-66bf1c2c976c.html"/> <#-- header -->
    </head>
    <body>
        <@_includePlace path="/c32a4f4a-ff5d-49cf-bb59-5d9784539174.html"/> <#-- 导航 -->

        <div class="banner-l3 position-relative d-flex align-items-center justify-content-center" style="background:#22407c url(${site.sitePath}assets/img/banner-l3-bg-1.png) 50% 50% no-repeat;">
            <div class="container text-center position-relative py-3 py-md-4 text-white">
                <div class="breadcrumbs fs-7 text-white d-inline-flex align-items-center text-opacity-50">
                    <a href="${site.sitePath}">首页</a>
                    &gt; <a href="${site.dynamicPath}account.html" data-id="member">${(metadata.alias)!}</a>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="row gx-5 justify-content-between my-5">
                <div class="col-md-3" style="border-right: 1px solid #ddd;">
                    <div class="guide-side fs-7 pe-4">
                        <@_includePlace path="/c936c718-5f19-426f-b3ff-13a5a8d63044.html"/> <#-- 个人中心导航 -->
                    </div>
                </div>
                <div class="col-md-9">
                    <div class="ps-4">
                        <@_tradeAccount id=user.id>
                        <h3>我的账户</h3>
                        <p><label class="input-label">余额:</label><label class="input-label">${object.amount}</label><span class="float-right"><label class="input-label">更新日期:</label>${object.updateDate!}</span></p>
                        <form action="${site.dynamicPath}tradeAccount/recharge" method="post">
                            <input type="hidden" name="_csrf" value="<@_csrfToken/>"/>
                            <input type="hidden" name="returnUrl" value="${site.dynamicPath}account.html"/>
                            <p><label class="input-label">充值:</label><input type="text" name="change" min="0.01" required="required"/> <label class="input-label">付款方式:</label><label><input type="radio" name="accountType" value="alipay"/>Alipay</label><label><input type="radio" name="accountType" value="wechat"/>Wechat</label> <input type="submit" class="button" value="支付"/></p>
                        </form>
                        </@_tradeAccount>
                        <#macro message code>${springMacroRequestContext.getMessage(code)}</#macro>
                        <#macro merge name value><#if !.vars[name]??><@"<#assign ${name}=''>"?interpret /></#if><#if value??><@"<#assign ${name}=${name}+'${value},'>"?interpret /></#if></#macro>
                        <@_tradeAccountHistoryList accountId=user.id pageIndex=pageIndex pageSize=10>
                        <h3>我的账户历史</h3>
                        <ul>
                            <#list page.list as a>
                            <@merge 'userIds' a.userId!/>
                            </#list>
                            <@_sysUser ids=userIds!><#assign userMap=map!/></@_sysUser>
                            <#list page.list as a>
                            <li class="underline">
                                <p><@message 'page.status.accountHistory.'+a.status/><span class="right">${a.createDate!} <label>操作人员:</label>${(userMap[a.userId?string].nickName)!}</span></p>
                                <p class="gray"><label>原始金额:</label>${a.amount!} <label>变化:</label>${a.amountChange!} <label>余额:</label>${a.balance!} </p>
                                <p>${a.description!}</p>
                            </li>
                            </#list>
                        </ul>
                        <ul class="pagination mt-5">
                            <#assign
                            start=1
                            end=page.totalPage
                            />
                            <#if (page.pageIndex-5) gt start>
                            <#assign start=page.pageIndex-4/>
                            </#if>
                            <#if (page.pageIndex+5) lt end>
                            <#assign end=page.pageIndex+4/>
                            </#if>
                            <#if !page.firstPage>
                            <a href="${getPage('account.html',page.prePage,'pageIndex')}">上一页</a>
                            <#else>
                            <span>上一页</span>
                            </#if>
                            <#if start gt 1>
                            <a href="${'account.html'}">1</a> ...
                            </#if>
                            <#list start..end as n>
                            <a href="${getPage('account.html',n,'pageIndex')}"${(n=page.pageIndex)?then(' class="selected"'?no_esc,'')}>${n}</a>
                            </#list>
                            <#if end lt page.totalPage>
                            ... <a href="${getPage('account.html',page.totalPage,'pageIndex')}">${page.totalPage}</a>
                            </#if>
                            <#if !page.lastPage>
                            <a href="${getPage('account.html',page.nextPage,'pageIndex')}">下一页</a>
                            <#else>
                            <span>下一页</span>
                            </#if>
                        </ul>
                        </@_tradeAccountHistoryList>
                    </div>
                </div>
            </div>
            </div>
        <script>
            var itemString="itemType=user&itemId=${user.id}";
        </script>
        <@_includePlace path="/7f8bacb5-30ca-4641-b66f-987d447b1a85.html"/> <#-- footer -->
    </body>
</html>